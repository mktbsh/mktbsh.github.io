var app=function(){"use strict";function t(){}const n=t=>t;function e(t){return t()}function o(){return Object.create(null)}function r(t){t.forEach(e)}function l(t){return"function"==typeof t}function c(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function i(n){return n&&l(n.destroy)?n.destroy:t}const s="undefined"!=typeof window;let u=s?()=>window.performance.now():()=>Date.now(),a=s?t=>requestAnimationFrame(t):t;const f=new Set;function d(t){f.forEach((n=>{n.c(t)||(f.delete(n),n.f())})),0!==f.size&&a(d)}function p(t,n){t.appendChild(n)}function m(t){if(!t)return document;const n=t.getRootNode?t.getRootNode():t.ownerDocument;return n.host?n:document}function h(t){const n=w("style");return function(t,n){p(t.head||t,n)}(m(t),n),n}function $(t,n,e){t.insertBefore(n,e||null)}function g(t){t.parentNode.removeChild(t)}function w(t){return document.createElement(t)}function y(t){return document.createTextNode(t)}function b(){return y(" ")}function x(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function v(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}const _=new Set;let C,k=0;function D(t,n,e,o,r,l,c,i=0){const s=16.666/o;let u="{\n";for(let t=0;t<=1;t+=s){const o=n+(e-n)*l(t);u+=100*t+`%{${c(o,1-o)}}\n`}const a=u+`100% {${c(e,1-e)}}\n}`,f=`__svelte_${function(t){let n=5381,e=t.length;for(;e--;)n=(n<<5)-n^t.charCodeAt(e);return n>>>0}(a)}_${i}`,d=m(t);_.add(d);const p=d.__svelte_stylesheet||(d.__svelte_stylesheet=h(t).sheet),$=d.__svelte_rules||(d.__svelte_rules={});$[f]||($[f]=!0,p.insertRule(`@keyframes ${f} ${a}`,p.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${f} ${o}ms linear ${r}ms 1 both`,k+=1,f}function E(t,n){const e=(t.style.animation||"").split(", "),o=e.filter(n?t=>t.indexOf(n)<0:t=>-1===t.indexOf("__svelte")),r=e.length-o.length;r&&(t.style.animation=o.join(", "),k-=r,k||a((()=>{k||(_.forEach((t=>{const n=t.__svelte_stylesheet;let e=n.cssRules.length;for(;e--;)n.deleteRule(e);t.__svelte_rules={}})),_.clear())})))}function A(t){C=t}function S(t){(function(){if(!C)throw new Error("Function called outside component initialization");return C})().$$.on_mount.push(t)}const R=[],j=[],O=[],z=[],N=Promise.resolve();let T=!1;function L(t){O.push(t)}let P=!1;const q=new Set;function B(){if(!P){P=!0;do{for(let t=0;t<R.length;t+=1){const n=R[t];A(n),I(n.$$)}for(A(null),R.length=0;j.length;)j.pop()();for(let t=0;t<O.length;t+=1){const n=O[t];q.has(n)||(q.add(n),n())}O.length=0}while(R.length);for(;z.length;)z.pop()();T=!1,P=!1,q.clear()}}function I(t){if(null!==t.fragment){t.update(),r(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(L)}}let H;function F(t,n,e){t.dispatchEvent(function(t,n,e=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,e,!1,n),o}(`${n?"intro":"outro"}${e}`))}const M=new Set;let U;function W(){U={r:0,c:[],p:U}}function Y(){U.r||r(U.c),U=U.p}function Z(t,n){t&&t.i&&(M.delete(t),t.i(n))}function G(t,n,e,o){if(t&&t.o){if(M.has(t))return;M.add(t),U.c.push((()=>{M.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}}const J={duration:0};function K(e,o,c,i){let s=o(e,c),p=i?0:1,m=null,h=null,$=null;function g(){$&&E(e,$)}function w(t,n){const e=t.b-p;return n*=Math.abs(e),{a:p,b:t.b,d:e,duration:n,start:t.start,end:t.start+n,group:t.group}}function y(o){const{delay:l=0,duration:c=300,easing:i=n,tick:y=t,css:b}=s||J,x={start:u()+l,b:o};o||(x.group=U,U.r+=1),m||h?h=x:(b&&(g(),$=D(e,p,o,c,l,i,b)),o&&y(0,1),m=w(x,c),L((()=>F(e,o,"start"))),function(t){let n;0===f.size&&a(d),new Promise((e=>{f.add(n={c:t,f:e})}))}((t=>{if(h&&t>h.start&&(m=w(h,c),h=null,F(e,m.b,"start"),b&&(g(),$=D(e,p,m.b,m.duration,0,i,s.css))),m)if(t>=m.end)y(p=m.b,1-p),F(e,m.b,"end"),h||(m.b?g():--m.group.r||r(m.group.c)),m=null;else if(t>=m.start){const n=t-m.start;p=m.a+m.d*i(n/m.duration),y(p,1-p)}return!(!m&&!h)})))}return{run(t){l(s)?(H||(H=Promise.resolve(),H.then((()=>{H=null}))),H).then((()=>{s=s(),y(t)})):y(t)},end(){g(),m=h=null}}}function Q(t){t&&t.c()}function V(t,n,o,c){const{fragment:i,on_mount:s,on_destroy:u,after_update:a}=t.$$;i&&i.m(n,o),c||L((()=>{const n=s.map(e).filter(l);u?u.push(...n):r(n),t.$$.on_mount=[]})),a.forEach(L)}function X(t,n){const e=t.$$;null!==e.fragment&&(r(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function tt(t,n){-1===t.$$.dirty[0]&&(R.push(t),T||(T=!0,N.then(B)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function nt(n,e,l,c,i,s,u,a=[-1]){const f=C;A(n);const d=n.$$={fragment:null,ctx:null,props:s,update:t,not_equal:i,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:e.context||[]),callbacks:o(),dirty:a,skip_bound:!1,root:e.target||f.$$.root};u&&u(d.root);let p=!1;if(d.ctx=l?l(n,e.props||{},((t,e,...o)=>{const r=o.length?o[0]:e;return d.ctx&&i(d.ctx[t],d.ctx[t]=r)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](r),p&&tt(n,t)),e})):[],d.update(),p=!0,r(d.before_update),d.fragment=!!c&&c(d.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);d.fragment&&d.fragment.l(t),t.forEach(g)}else d.fragment&&d.fragment.c();e.intro&&Z(n.$$.fragment),V(n,e.target,e.anchor,e.customElement),B()}A(f)}class et{$destroy(){X(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var ot=(t,n)=>{const e=n=>{let e={};Array.isArray(n)?n.forEach((t=>{e={...e,...t}})):e=n,Object.entries(e).forEach((([n,e])=>{n=n.replace(/[A-Z]/,(t=>"-"+t.toLowerCase())),t.style.setProperty(n,e)}))};return e(n),{update:e}};function rt(n){let e,o,c;return{c(){e=w("button"),e.textContent="🔓",v(e,"type","button")},m(t,r){$(t,e,r),o||(c=[i(ot.call(null,e,{background:"none",border:"none",cursor:"pointer",fontSize:"28px",lineHeight:1,margin:"4px",textAlign:"center",padding:"4px",position:"absolute",top:0,right:0,zIndex:9998})),x(e,"click",(function(){l(n[0])&&n[0].apply(this,arguments)}))],o=!0)},p(t,[e]){n=t},i:t,o:t,d(t){t&&g(e),o=!1,r(c)}}}function lt(t,n,e){let{onClick:o}=n;return t.$$set=t=>{"onClick"in t&&e(0,o=t.onClick)},[o]}class ct extends et{constructor(t){super(),nt(this,t,lt,rt,c,{onClick:0})}}function it(t){const n=t-1;return n*n*n+1}function st(t,{delay:n=0,duration:e=400,easing:o=it,x:r=0,y:l=0,opacity:c=0}={}){const i=getComputedStyle(t),s=+i.opacity,u="none"===i.transform?"":i.transform,a=s*(1-c);return{delay:n,duration:e,easing:o,css:(t,n)=>`\n\t\t\ttransform: ${u} translate(${(1-t)*r}px, ${(1-t)*l}px);\n\t\t\topacity: ${s-a*n}`}}function ut(n){let e,o,c,s;return{c(){e=w("button"),o=y(n[0]),v(e,"type","button")},m(t,r){$(t,e,r),p(e,o),c||(s=[i(ot.call(null,e,{fontSize:"20px",padding:"0 4px",margin:"4px"})),x(e,"click",(function(){l(n[1])&&n[1].apply(this,arguments)}))],c=!0)},p(t,[e]){n=t,1&e&&function(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}(o,n[0])},i:t,o:t,d(t){t&&g(e),c=!1,r(s)}}}function at(t,n,e){let{emoji:o}=n,{onClick:r}=n;return t.$$set=t=>{"emoji"in t&&e(0,o=t.emoji),"onClick"in t&&e(1,r=t.onClick)},[o,r]}class ft extends et{constructor(t){super(),nt(this,t,at,ut,c,{emoji:0,onClick:1})}}function dt(n){let e,o,c;return{c(){e=w("button"),e.textContent="🔐",v(e,"type","button")},m(t,r){$(t,e,r),o||(c=[i(ot.call(null,e,{background:"none",border:"none",cursor:"pointer",fontSize:"28px",lineHeight:1,margin:"4px",textAlign:"center",padding:"4px",position:"absolute",top:0,left:0})),x(e,"click",(function(){l(n[0])&&n[0].apply(this,arguments)}))],o=!0)},p(t,[e]){n=t},i:t,o:t,d(t){t&&g(e),o=!1,r(c)}}}function pt(t,n,e){let{onClick:o}=n;return t.$$set=t=>{"onClick"in t&&e(0,o=t.onClick)},[o]}class mt extends et{constructor(t){super(),nt(this,t,pt,dt,c,{onClick:0})}}const ht=t=>t&&"function"==typeof t,$t=t=>{switch(t){case"www.youtube.com":case"localhost":return!0;default:return!1}};function gt(t){let n,e,o,c,s,u,a=ht(t[0]),f=a&&wt(t);return{c(){n=w("div"),e=w("button"),e.textContent="🗑",o=b(),f&&f.c()},m(r,a){$(r,n,a),p(n,e),p(n,o),f&&f.m(n,null),s||(u=[x(e,"click",(function(){l(t[1])&&t[1].apply(this,arguments)})),i(c=ot.call(null,n,{position:"absolute",top:0,left:0,zIndex:2}))],s=!0)},p(e,o){t=e,1&o&&(a=ht(t[0])),a?f?f.p(t,o):(f=wt(t),f.c(),f.m(n,null)):f&&(f.d(1),f=null)},d(t){t&&g(n),f&&f.d(),s=!1,r(u)}}}function wt(t){let n,e,o;return{c(){n=w("button"),n.textContent="💾"},m(r,c){$(r,n,c),e||(o=x(n,"click",(function(){l(t[0])&&t[0].apply(this,arguments)})),e=!0)},p(n,e){t=n},d(t){t&&g(n),e=!1,o()}}}function yt(n){let e,o,r,l=n[3]&&gt(n);return{c(){e=w("div"),l&&l.c()},m(t,c){$(t,e,c),l&&l.m(e,null),n[5](e),o||(r=i(ot.call(null,e,{width:"100%",position:"relative"})),o=!0)},p(t,[n]){t[3]?l?l.p(t,n):(l=gt(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:t,o:t,d(t){t&&g(e),l&&l.d(),n[5](null),o=!1,r()}}}function bt(t,n,e){let o,{canvas:r}=n,{onDownload:l}=n,{onDelete:c}=n,i=!1;return S((()=>{o.appendChild(r),e(3,i=!0)})),t.$$set=t=>{"canvas"in t&&e(4,r=t.canvas),"onDownload"in t&&e(0,l=t.onDownload),"onDelete"in t&&e(1,c=t.onDelete)},[l,c,o,i,r,function(t){j[t?"unshift":"push"]((()=>{o=t,e(2,o)}))}]}class xt extends et{constructor(t){super(),nt(this,t,bt,yt,c,{canvas:4,onDownload:0,onDelete:1})}}function vt(t,n,e){const o=t.slice();return o[8]=n[e],o}function _t(t){let n,e,o,l,c,s,u,a,f,d,m,h,y,x,v,_,C,k;e=new mt({props:{onClick:t[7]}}),a=new ft({props:{emoji:"📸",onClick:t[3]}});let D=t[1]&&Ct(t);m=new ft({props:{emoji:"🗑",onClick:t[5]}});let E=t[2],A=[];for(let n=0;n<E.length;n+=1)A[n]=kt(vt(t,E,n));const S=t=>G(A[t],1,1,(()=>{A[t]=null}));return{c(){n=w("div"),Q(e.$$.fragment),o=b(),l=w("h2"),l.textContent="CAPTURE",s=b(),u=w("div"),Q(a.$$.fragment),f=b(),D&&D.c(),d=b(),Q(m.$$.fragment),y=b();for(let t=0;t<A.length;t+=1)A[t].c()},m(t,r){$(t,n,r),V(e,n,null),p(n,o),p(n,l),p(n,s),p(n,u),V(a,u,null),p(u,f),D&&D.m(u,null),p(u,d),V(m,u,null),p(n,y);for(let t=0;t<A.length;t+=1)A[t].m(n,null);_=!0,C||(k=[i(c=ot.call(null,l,{margin:"0",textAlign:"center",color:"#31426c",marginBottom:"0.5rem"})),i(h=ot.call(null,u,{textAlign:"center",borderRadius:"3px",padding:"4px",marginBottom:"1rem"})),i(x=ot.call(null,n,{position:"fixed",top:"10%",right:0,height:"100%",padding:"0.5rem 1rem",borderLeft:"1 solid #aaa",background:"#fff",overflowY:"auto",width:"375px",border:"1px solid #000",zIndex:9999}))],C=!0)},p(t,o){const r={};if(1&o&&(r.onClick=t[7]),e.$set(r),t[1]?D?(D.p(t,o),2&o&&Z(D,1)):(D=Ct(t),D.c(),Z(D,1),D.m(u,d)):D&&(W(),G(D,1,1,(()=>{D=null})),Y()),4&o){let e;for(E=t[2],e=0;e<E.length;e+=1){const r=vt(t,E,e);A[e]?(A[e].p(r,o),Z(A[e],1)):(A[e]=kt(r),A[e].c(),Z(A[e],1),A[e].m(n,null))}for(W(),e=E.length;e<A.length;e+=1)S(e);Y()}},i(t){if(!_){Z(e.$$.fragment,t),Z(a.$$.fragment,t),Z(D),Z(m.$$.fragment,t);for(let t=0;t<E.length;t+=1)Z(A[t]);L((()=>{v||(v=K(n,st,{x:375,opacity:1},!0)),v.run(1)})),_=!0}},o(t){G(e.$$.fragment,t),G(a.$$.fragment,t),G(D),G(m.$$.fragment,t),A=A.filter(Boolean);for(let t=0;t<A.length;t+=1)G(A[t]);v||(v=K(n,st,{x:375,opacity:1},!1)),v.run(0),_=!1},d(t){t&&g(n),X(e),X(a),D&&D.d(),X(m),function(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}(A,t),t&&v&&v.end(),C=!1,r(k)}}}function Ct(n){let e,o;return e=new ft({props:{emoji:"💾",onClick:n[4]}}),{c(){Q(e.$$.fragment)},m(t,n){V(e,t,n),o=!0},p:t,i(t){o||(Z(e.$$.fragment,t),o=!0)},o(t){G(e.$$.fragment,t),o=!1},d(t){X(e,t)}}}function kt(t){let n,e;return n=new xt({props:{canvas:t[8].canvas,onDelete:t[8].onDelete,onDownload:t[8].onDownload}}),{c(){Q(n.$$.fragment)},m(t,o){V(n,t,o),e=!0},p(t,e){const o={};4&e&&(o.canvas=t[8].canvas),4&e&&(o.onDelete=t[8].onDelete),4&e&&(o.onDownload=t[8].onDownload),n.$set(o)},i(t){e||(Z(n.$$.fragment,t),e=!0)},o(t){G(n.$$.fragment,t),e=!1},d(t){X(n,t)}}}function Dt(t){let n,e,o=t[0]&&_t(t);return{c(){o&&o.c(),n=y("")},m(t,r){o&&o.m(t,r),$(t,n,r),e=!0},p(t,[e]){t[0]?o?(o.p(t,e),1&e&&Z(o,1)):(o=_t(t),o.c(),Z(o,1),o.m(n.parentNode,n)):o&&(W(),G(o,1,1,(()=>{o=null})),Y())},i(t){e||(Z(o),e=!0)},o(t){G(o),e=!1},d(t){o&&o.d(t),t&&g(n)}}}function Et(t,n,e){let{show:o=!1}=n,{allowCORS:r=!1}=n,{video:l}=n,c=[];return t.$$set=t=>{"show"in t&&e(0,o=t.show),"allowCORS"in t&&e(1,r=t.allowCORS),"video"in t&&e(6,l=t.video)},[o,r,c,()=>{console.log("handleCapture");const t=`${Date.now()}`;console.log("timestamp:",t);const n=(t=>{const n=document.createElement("canvas");return n.style.cssText="width:100%",n.setAttribute("width",`${t.videoWidth}`),n.setAttribute("height",`${t.videoHeight}`),n.getContext("2d").drawImage(t,0,0,n.width,n.height),n})(l),o=()=>{e(2,c=c.filter((n=>n.timestamp!==t)))},i={timestamp:t,canvas:n,onDelete:o,onDownload:r?()=>{const e=document.createElement("a");e.download=`${t}.png`,e.href=n.toDataURL(),e.click(),e.remove(),o()}:void 0};console.log("entity:",i),c.push(i),e(2,c)},()=>{c.forEach((t=>t.onDownload()))},()=>{c.forEach((t=>t.onDelete()))},l,()=>e(0,o=!1)]}class At extends et{constructor(t){super(),nt(this,t,Et,Dt,c,{show:0,allowCORS:1,video:6})}}function St(t){let n,e,o,r;return n=new ct({props:{onClick:t[3]}}),o=new At({props:{show:t[1],video:t[2],allowCORS:$t(t[0])}}),{c(){Q(n.$$.fragment),e=b(),Q(o.$$.fragment)},m(t,l){V(n,t,l),$(t,e,l),V(o,t,l),r=!0},p(t,[e]){const r={};2&e&&(r.onClick=t[3]),n.$set(r);const l={};2&e&&(l.show=t[1]),1&e&&(l.allowCORS=$t(t[0])),o.$set(l)},i(t){r||(Z(n.$$.fragment,t),Z(o.$$.fragment,t),r=!0)},o(t){G(n.$$.fragment,t),G(o.$$.fragment,t),r=!1},d(t){X(n,t),t&&g(e),X(o,t)}}}function Rt(t,n,e){let{host:o}=n;console.log(o);let r=!1,l=(t=>{const n=document.querySelectorAll("video");switch(console.log(n),t){case"www.youtube.com":case"localhost":default:return n[0]}})(o);return t.$$set=t=>{"host"in t&&e(0,o=t.host)},[o,r,l,()=>e(1,r=!r)]}class jt extends et{constructor(t){super(),nt(this,t,Rt,St,c,{host:0})}}return(()=>{((t=1e3)=>{const n=new Date;for(;;)if(Date.now()-n.getTime()>t){console.log(Date.now()-n.getTime()+"ms経過。Sleep終了");break}})(3e3);return document.querySelectorAll("video").length?new jt({target:document.body,props:{host:window.location.hostname}}):null})()}();
